{
  "protocol_version": "ui-patterns-v1",
  "description": "Canonical UI pattern catalog for RogueCity Visualizer",
  "architecture_version": "RC-0.10 Master Panel",
  
  "patterns": [
    {
      "name": "MasterPanel",
      "template": "RcMasterPanel",
      "roles": ["container", "router", "master"],
      "description": "Root panel container with registry-based drawer routing. Provides hybrid tabs+search navigation, popout support, and state-reactive visibility. Single ImGui window hosts all 19 panel drawers",
      "required_tags": ["master", "registry", "tabs"],
      "suggested_widgets": ["tab_bar", "search_overlay", "popout_button"],
      "examples": [
        "visualizer/src/ui/panels/RcMasterPanel.cpp"
      ],
      "notes": "RC-0.10 architecture refactor: replaces individual panel windows with unified container. Ctrl+P opens search overlay."
    },
    {
      "name": "PanelDrawer",
      "template": "IPanelDrawer",
      "roles": ["drawer", "panel_content"],
      "description": "Content-only panel interface for Master Panel architecture. Drawers render without window creation - Master Panel owns ImGui::Begin/End",
      "required_tags": ["drawer"],
      "suggested_widgets": ["none - content only"],
      "examples": [
        "visualizer/src/ui/panels/RcPanelDrawers.cpp"
      ],
      "notes": "Each panel implements draw(DrawContext&) method. No ImGui::Begin/End in drawers."
    },
    {
      "name": "InspectorPanel",
      "template": "RcInspectorPanel<T>",
      "roles": ["inspector"],
      "description": "Detail view for a selected entity with labeled property fields",
      "required_tags": ["detail", "selection"],
      "suggested_widgets": ["property_editor", "readonly_label", "collapsing_header"],
      "examples": [
        "rc_axiom_inspector",
        "rc_road_inspector"
      ]
    },
    {
      "name": "PropertyEditor",
      "template": "RcPropertyEditor",
      "roles": ["context_sensitive_inspector", "inspector"],
      "description": "Context-sensitive property grid that renders manual per-type fields",
      "required_tags": ["detail", "selection", "property_editor"],
      "suggested_widgets": ["property_editor", "combo", "checkbox", "input"],
      "examples": [
        "rc_panel_inspector"
      ]
    },
    {
      "name": "ToolStrip",
      "template": "RcToolStrip",
      "roles": ["toolbox"],
      "description": "Horizontal/vertical toolbar with grouped action buttons",
      "required_tags": ["toolbar", "actions"],
      "suggested_widgets": ["button", "button_group", "separator"],
      "examples": [
        "rc_axiom_toolbar",
        "rc_road_toolbar",
        "rc_panel_tools"
      ]
    },
    {
      "name": "DataIndexPanel",
      "template": "RcDataIndexPanel<T>",
      "roles": ["index"],
      "description": "Sortable/filterable table of entities with selection",
      "required_tags": ["table", "selection"],
      "suggested_widgets": ["table", "filter_input", "column_header"],
      "examples": [
        "rc_panel_road_index",
        "rc_panel_district_index",
        "rc_panel_lot_index",
        "rc_panel_river_index"
      ]
    },
    {
      "name": "MetricsPanel",
      "template": "RcMetricsPanel",
      "roles": ["inspector", "debug"],
      "description": "Panel showing numeric metrics, trends, and performance data",
      "required_tags": ["metrics", "readonly"],
      "suggested_widgets": ["property_editor", "sparkline", "plot"],
      "examples": [
        "rc_panel_telemetry",
        "rc_panel_analytics"
      ]
    },
    {
      "name": "LogPanel",
      "template": "RcLogPanel",
      "roles": ["log"],
      "description": "Scrolling log output with filtering and level indicators",
      "required_tags": ["log", "scrolling"],
      "suggested_widgets": ["scrolling_list", "filter_input", "color_text"],
      "examples": [
        "rc_panel_log"
      ]
    },
    {
      "name": "PrimaryViewport",
      "template": "RcPrimaryViewport",
      "roles": ["viewport"],
      "description": "Main 3D/2D visualization canvas with camera controls",
      "required_tags": ["viewport", "canvas"],
      "suggested_widgets": ["framebuffer", "camera_controls", "overlay"],
      "examples": [
        "rogue_visualizer"
      ]
    },
    {
      "name": "NavOverlay",
      "template": "RcNavOverlay",
      "roles": ["nav"],
      "description": "Minimap or navigation overview panel",
      "required_tags": ["minimap", "navigation"],
      "suggested_widgets": ["framebuffer", "viewport_indicator"],
      "examples": [
        "minimap_viewport"
      ]
    },
    {
      "name": "ControlPanel",
      "template": "RcControlPanel",
      "roles": ["control"],
      "description": "System control interface (start/stop, config)",
      "required_tags": ["control", "system"],
      "suggested_widgets": ["button", "status_indicator", "collapsing_header"],
      "examples": [
        "rc_panel_ai_console"
      ]
    },
    {
      "name": "GeneratorPanel",
      "template": "RcGeneratorPanel",
      "roles": ["generator"],
      "description": "Input form for AI-driven generation with preview",
      "required_tags": ["generator", "input"],
      "suggested_widgets": ["text_input", "combo", "button", "preview"],
      "examples": [
        "rc_panel_city_spec",
        "rc_panel_ui_agent"
      ]
    }
  ],
  
  "current_panels": [
    {
      "id": "rc_axiom_inspector",
      "pattern": "InspectorPanel",
      "role": "inspector",
      "owner_module": "rc_panel_axiom_editor",
      "tags": ["axiom", "detail", "selection"]
    },
    {
      "id": "rc_panel_tools",
      "pattern": "ToolStrip",
      "role": "toolbox",
      "owner_module": "rc_panel_tools",
      "tags": ["tools", "actions"]
    },
    {
      "id": "rc_panel_inspector",
      "pattern": "PropertyEditor",
      "role": "inspector",
      "owner_module": "rc_panel_inspector",
      "tags": ["detail", "selection", "property_editor"],
      "data_bindings": ["selection_manager"]
    },
    {
      "id": "rc_panel_road_index",
      "pattern": "DataIndexPanel",
      "role": "index",
      "owner_module": "rc_panel_road_index",
      "tags": ["road", "table", "selection"]
    },
    {
      "id": "rc_panel_district_index",
      "pattern": "DataIndexPanel",
      "role": "index",
      "owner_module": "rc_panel_district_index",
      "tags": ["district", "table", "selection"]
    },
    {
      "id": "rc_panel_lot_index",
      "pattern": "DataIndexPanel",
      "role": "index",
      "owner_module": "rc_panel_lot_index",
      "tags": ["lot", "table", "selection"]
    },
    {
      "id": "rc_panel_building_index",
      "pattern": "DataIndexPanel",
      "role": "index",
      "owner_module": "rc_panel_building_index",
      "tags": ["building", "table", "selection"],
      "data_bindings": ["buildings[]"],
      "state_visibility": ["Editing_Buildings"]
    },
    {
      "id": "rc_panel_zoning_control",
      "pattern": "ControlPanel",
      "role": "toolbox",
      "owner_module": "rc_panel_zoning_control",
      "tags": ["zoning", "generator", "control"],
      "data_bindings": ["districts[]", "lots[]", "buildings[]", "aesp_scores"],
      "state_visibility": ["Editing_Districts", "Editing_Lots", "Editing_Buildings"]
    },
    {
      "id": "rc_panel_river_index",
      "pattern": "DataIndexPanel",
      "role": "index",
      "owner_module": "rc_panel_river_index",
      "tags": ["river", "table", "selection"]
    },
    {
      "id": "rc_panel_telemetry",
      "pattern": "MetricsPanel",
      "role": "inspector",
      "owner_module": "rc_panel_telemetry",
      "tags": ["metrics", "performance"]
    },
    {
      "id": "rc_panel_log",
      "pattern": "LogPanel",
      "role": "log",
      "owner_module": "rc_panel_log",
      "tags": ["log", "debug"]
    },
    {
      "id": "rogue_visualizer",
      "pattern": "PrimaryViewport",
      "role": "viewport",
      "owner_module": "rc_ui_rogue_visualizer",
      "tags": ["viewport", "3d"]
    },
    {
      "id": "rc_panel_ai_console",
      "pattern": "ControlPanel",
      "role": "control",
      "owner_module": "rc_panel_ai_console",
      "tags": ["ai", "control", "system"]
    },
    {
      "id": "rc_panel_ui_agent",
      "pattern": "GeneratorPanel",
      "role": "generator",
      "owner_module": "rc_panel_ui_agent",
      "tags": ["ai", "layout", "input"]
    },
    {
      "id": "rc_panel_city_spec",
      "pattern": "GeneratorPanel",
      "role": "generator",
      "owner_module": "rc_panel_city_spec",
      "tags": ["ai", "city", "input"]
    }
  ],
  
  "refactoring_opportunities": [
    {
      "name": "Extract common DataIndexPanel pattern",
      "priority": "high",
      "affected_panels": [
        "rc_panel_road_index",
        "rc_panel_district_index",
        "rc_panel_lot_index",
        "rc_panel_river_index"
      ],
      "suggested_action": "Create generic RcDataIndexPanel<T> template in visualizer/src/ui/patterns/rc_ui_data_index_panel.h",
      "rationale": "4 panels with nearly identical code structure (table + selection + filter)",
      "estimated_reduction": "~80% code duplication"
    },
    {
      "name": "Unify AI generator panels",
      "priority": "medium",
      "affected_panels": [
        "rc_panel_ui_agent",
        "rc_panel_city_spec"
      ],
      "suggested_action": "Extract common RcAiGeneratorPanel base class",
      "rationale": "Shared patterns: bridge status check, input field, generate button, result display",
      "estimated_reduction": "~60% code duplication"
    }
  ]
}
