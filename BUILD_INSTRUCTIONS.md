# RogueCity Solution Build - Quick Start Guide

## What Changed

Your project has been refactored to use a **Visual Studio solution** (`build_vs/RogueCities.sln`) generated by CMake. This provides better integration with Visual Studio and organized project structure.

### Solution Structure

The solution contains these key projects:

1. **RogueCityCore** - Core library (data types, math)
2. **RogueCityGenerators** - Procedural generation algorithms
3. **RogueCityApp** - Application layer (HFSM, integration)
4. **RogueCityAI** - AI assistant integration
5. **RogueCityImGui** - ImGui library wrapper
6. **RogueCityVisualizerGui** ? - Main GUI application (your startup project)
7. **RogueCityVisualizerHeadless** - Headless version
8. Test projects (test_core, test_generators, test_editor_hfsm, etc.)

### Output Location

Built executables are now in: `bin/RogueCityVisualizerGui.exe`

## How to Build and Run

### Option 1: Visual Studio (Recommended)

```powershell
# Open the solution in Visual Studio
start build_vs\RogueCities.sln
```

Then:
1. Set **RogueCityVisualizerGui** as startup project (right-click ? Set as Startup Project)
2. Select **Release** or **Debug** configuration
3. Press **F5** to build and run

### Option 2: Command Line

```powershell
# Build
cmake --build build_vs --target RogueCityVisualizerGui --config Release --parallel 4

# Run
.\bin\RogueCityVisualizerGui.exe
```

### Option 3: Quick Script

Simply run the provided batch script:

```powershell
.\build_and_run.bat
```

## Configuration

If you need to reconfigure the build (e.g., after pulling new changes), run:

```powershell
cmake -B build_vs -S . -DROGUECITY_BUILD_VISUALIZER=ON
```

## Geometry Migration Flags

The build now supports dual geometry backend flags for incremental migration:

```powershell
# Legacy path (GEOS if available, otherwise legacy shim)
cmake -B build_vs -S . -DUSE_LEGACY_GEOS=ON

# Boost.Geometry path (falls back to legacy shim if Boost is unavailable)
cmake -B build_vs -S . -DUSE_LEGACY_GEOS=OFF
```

Recommended vcpkg install command for migration dependencies:

```powershell
vcpkg install boost-geometry fastnoise2 nanoflann delaunator-cpp
```

Optional terrain backend is auto-detected from `3rdparty/SLTerrainGeneration` when:

```powershell
-DROGUECITY_ENABLE_SLTERRAIN=ON
```

## Recent Fixes Applied

1. **Missing header include** - Added `GlobalState.hpp` include to `rc_panel_tools.cpp`
2. **Missing source files** - Added control panel cpp files to CMakeLists.txt:
   - `rc_panel_lot_control.cpp`
   - `rc_panel_building_control.cpp`
   - `rc_panel_water_control.cpp`

## Key Features in Current Build (RC-0.10)

- **AI Integration** - AI Bridge with toolserver integration
- **HFSM State Machine** - Editor state management
- **Zoning System** - Lot subdivision and building placement
- **UI Panels** - State-reactive control panels
- **Viewport Overlays** - District colors, AESP visualization
- **Index Panels** - Browse axioms, roads, districts, lots, buildings

## Troubleshooting

### If build fails with path errors:
```powershell
Remove-Item build_vs/CMakeCache.txt -Force
cmake -B build_vs -S . -DROGUECITY_BUILD_VISUALIZER=ON
```

### If visualizer is disabled:
Make sure to configure with the visualizer flag:
```powershell
cmake -B build_vs -S . -DROGUECITY_BUILD_VISUALIZER=ON
```

### Check build output:
The executable should be at: `bin/RogueCityVisualizerGui.exe`

## Next Steps

1. **Explore the UI** - The application has a docked ImGui interface
2. **Try the tools** - Use the axiom, road, and district tools
3. **Check the panels** - AI Console, Telemetry, Index panels
4. **Review the code** - See the copilot instructions for architecture details

Enjoy your RogueCity Urban Spatial Designer! ???
